{
  "pageContent": "File Path: src/net/jforum/api/integration/mail/pop/POPListener.java\n\n Original Content: /*\n * Created on 21/08/2006 21:07:36\n */\npackage net.jforum.api.integration.mail.pop;\n\nimport java.util.Iterator;\nimport java.util.List;\n\nimport net.jforum.dao.DataAccessDriver;\nimport net.jforum.entities.MailIntegration;\n\nimport org.apache.log4j.Logger;\nimport org.quartz.Job;\nimport org.quartz.JobExecutionContext;\nimport org.quartz.JobExecutionException;\n\n/**\n * @author Rafael Steil\n * @version $Id: POPListener.java,v 1.9 2006/10/10 01:59:55 rafaelsteil Exp $\n */\npublic class POPListener implements Job\n{\n\tprivate static final Logger logger = Logger.getLogger(POPListener.class);\n\tprivate static boolean working;\n\tprotected POPConnector connector = new POPConnector();\n\t\n\t/**\n\t * @see org.quartz.Job#execute(org.quartz.JobExecutionContext)\n\t */\n\tpublic void execute(JobExecutionContext jobContext) throws JobExecutionException\n\t{\n\t\tif (!working) {\n\t\t\ttry {\n\t\t\t\tworking = true;\n\n\t\t\t\tList integrationList = DataAccessDriver.getInstance().newMailIntegrationDAO().findAll();\n\t\t\t\tPOPParser parser = new POPParser();\n\t\t\t\t\n\t\t\t\tfor (Iterator iter = integrationList.iterator(); iter.hasNext(); ) {\n\t\t\t\t\tMailIntegration integration = (MailIntegration)iter.next();\n\t\t\t\t\t\n\t\t\t\t\tconnector.setMailIntegration(integration);\n\t\t\t\t\t\n\t\t\t\t\ttry {\n\t\t\t\t\t\tlogger.debug(\"Going to check \" + integration);\n\t\t\t\t\t\t\n\t\t\t\t\t\tconnector.openConnection();\n\t\t\t\t\t\tparser.parseMessages(connector);\n\t\t\t\t\t\t\n\t\t\t\t\t\tPOPPostAction postAction = new POPPostAction();\n\t\t\t\t\t\tpostAction.insertMessages(parser);\n\t\t\t\t\t}\n\t\t\t\t\tfinally {\n\t\t\t\t\t\tconnector.closeConnection();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tfinally {\n\t\t\t\tworking = false;\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tlogger.debug(\"Already working. Leaving for now.\");\n\t\t}\n\t}\n\t\n\tPOPConnector getConnector()\n\t{\n\t\treturn this.connector;\n\t}\n}",
  "metadata": {
    "fileId": "POPListener_java_chunk_1",
    "fileName": "POPListener.java",
    "filePath": "src/net/jforum/api/integration/mail/pop/POPListener.java"
  }
}
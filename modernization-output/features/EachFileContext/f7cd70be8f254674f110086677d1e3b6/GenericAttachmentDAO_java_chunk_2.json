{
  "pageContent": "File Path: src/net/jforum/dao/generic/GenericAttachmentDAO.java\n\n Original Content: public class GenericAttachmentDAO extends AutoKeys implements net.jforum.dao.AttachmentDAO\n{\n\t/**\n\t * @see net.jforum.dao.AttachmentDAO#addQuotaLimit(net.jforum.entities.QuotaLimit)\n\t */\n\tpublic void addQuotaLimit(QuotaLimit limit)\n\t{\n\t\tPreparedStatement p = null;\n\t\ttry {\n\t\t\tp = JForumExecutionContext.getConnection().prepareStatement(\n\t\t\t\t\tSystemGlobals.getSql(\"AttachmentModel.addQuotaLimit\"));\n\t\t\tp.setString(1, limit.getDescription());\n\t\t\tp.setInt(2, limit.getSize());\n\t\t\tp.setInt(3, limit.getType());\n\t\t\tp.executeUpdate();\n\t\t}\n\t\tcatch (SQLException e) {\n\t\t\tthrow new DatabaseException(e);\n\t\t}\n\t\tfinally {\n\t\t\tDbUtils.close(p);\n\t\t}\n\t}\n\n\t/**\n\t * @see net.jforum.dao.AttachmentDAO#updateQuotaLimit(net.jforum.entities.QuotaLimit)\n\t */\n\tpublic void updateQuotaLimit(QuotaLimit limit)\n\t{\n\t\tPreparedStatement p = null;\n\t\ttry {\n\t\t\tp = JForumExecutionContext.getConnection().prepareStatement(\n\t\t\t\t\tSystemGlobals.getSql(\"AttachmentModel.updateQuotaLimit\"));\n\t\t\tp.setString(1, limit.getDescription());\n\t\t\tp.setInt(2, limit.getSize());\n\t\t\tp.setInt(3, limit.getType());\n\t\t\tp.setInt(4, limit.getId());\n\t\t\tp.executeUpdate();\n\t\t}\n\t\tcatch (SQLException e) {\n\t\t\tthrow new DatabaseException(e);\n\t\t}\n\t\tfinally {\n\t\t\tDbUtils.close(p);\n\t\t}\n\t}\n\n\t/**\n\t * @see net.jforum.dao.AttachmentDAO#cleanGroupQuota()\n\t */\n\tpublic void cleanGroupQuota()\n\t{\n\t\tPreparedStatement p = null;\n\t\ttry {\n\t\t\tp = JForumExecutionContext.getConnection().prepareStatement(\n\t\t\t\t\tSystemGlobals.getSql(\"AttachmentModel.deleteGroupQuota\"));\n\t\t\tp.executeUpdate();\n\t\t}\n\t\tcatch (SQLException e) {\n\t\t\tthrow new DatabaseException(e);\n\t\t}\n\t\tfinally {\n\t\t\tDbUtils.close(p);\n\t\t}\n\t}\n\n\t/**\n\t * @see net.jforum.dao.AttachmentDAO#setGroupQuota(int, int)\n\t */\n\tpublic void setGroupQuota(int groupId, int quotaId)\n\t{\n\t\tPreparedStatement p = null;\n\t\ttry {\n\t\t\tp = JForumExecutionContext.getConnection().prepareStatement(\n\t\t\t\t\tSystemGlobals.getSql(\"AttachmentModel.setGroupQuota\"));\n\t\t\tp.setInt(1, groupId);\n\t\t\tp.setInt(2, quotaId);\n\t\t\tp.executeUpdate();\n\t\t}\n\t\tcatch (SQLException e) {\n\t\t\tthrow new DatabaseException(e);\n\t\t}\n\t\tfinally {\n\t\t\tDbUtils.close(p);\n\t\t}\n\t}\n\n\t/**\n\t * @see net.jforum.dao.AttachmentDAO#removeQuotaLimit(int)\n\t */\n\tpublic void removeQuotaLimit(int id)\n\t{\n\t\tthis.removeQuotaLimit(new String[] { Integer.toString(id) });\n\t}\n\n\t/**\n\t * @see net.jforum.dao.AttachmentDAO#removeQuotaLimit(java.lang.String[])\n\t */\n\tpublic void removeQuotaLimit(String[] ids)\n\t{\n\t\tPreparedStatement p = null;\n\t\ttry {\n\t\t\tp = JForumExecutionContext.getConnection().prepareStatement(\n\t\t\t\t\tSystemGlobals.getSql(\"AttachmentModel.removeQuotaLimit\"));\n\n\t\t\tfor (int i = 0; i < ids.length; i++) {\n\t\t\t\tp.setInt(1, Integer.parseInt(ids[i]));\n\t\t\t\tp.executeUpdate();\n\t\t\t}\n\t\t}\n\t\tcatch (SQLException e) {\n\t\t\tthrow new DatabaseException(e);\n\t\t}\n\t\tfinally {\n\t\t\tDbUtils.close(p);\n\t\t}\n\t}\n\n\t/**\n\t * @see net.jforum.dao.AttachmentDAO#selectQuotaLimit()\n\t */\n\tpublic List selectQuotaLimit()\n\t{\n\t\tList l = new ArrayList();\n\t\tPreparedStatement p = null;\n\t\tResultSet rs = null;\n\t\ttry {\n\t\t\tp = JForumExecutionContext.getConnection().prepareStatement(\n\t\t\t\t\tSystemGlobals.getSql(\"AttachmentModel.selectQuotaLimit\"));\n\n\t\t\trs = p.executeQuery();\n\t\t\twhile (rs.next()) {\n\t\t\t\tl.add(this.getQuotaLimit(rs));\n\t\t\t}\n\n\t\t\treturn l;\n\t\t}\n\t\tcatch (SQLException e) {\n\t\t\tthrow new DatabaseException(e);\n\t\t}\n\t\tfinally {\n\t\t\tDbUtils.close(rs, p);\n\t\t}\n\t}\n\n\t/**\n\t * @see net.jforum.dao.AttachmentDAO#selectQuotaLimit()\n\t */\n\tpublic QuotaLimit selectQuotaLimitByGroup(int groupId)\n\t{\n\t\tQuotaLimit ql = null;\n\n\t\tPreparedStatement p = null;\n\t\tResultSet rs = null;\n\t\ttry {\n\t\t\tp = JForumExecutionContext.getConnection().prepareStatement(\n\t\t\t\t\tSystemGlobals.getSql(\"AttachmentModel.selectQuotaLimitByGroup\"));\n\t\t\tp.setInt(1, groupId);\n\n\t\t\trs = p.executeQuery();\n\t\t\tif (rs.next()) {\n\t\t\t\tql = this.getQuotaLimit(rs);\n\t\t\t}\n\t\t\treturn ql;\n\t\t}\n\t\tcatch (SQLException e) {\n\t\t\tthrow new DatabaseException(e);\n\t\t}\n\t\tfinally {\n\t\t\tDbUtils.close(rs, p);\n\t\t}\n\t}\n\n\t/**\n\t * @see net.jforum.dao.AttachmentDAO#selectGroupsQuotaLimits()\n\t */\n\tpublic Map selectGroupsQuotaLimits()\n\t{\n\t\tMap m = new HashMap();\n\t\tPreparedStatement p = null;\n\t\tResultSet rs = null;\n\t\ttry {\n\t\t\tp = JForumExecutionContext.getConnection().prepareStatement(\n\t\t\t\t\tSystemGlobals.getSql(\"AttachmentModel.selectGroupsQuotaLimits\"));\n\n\t\t\trs = p.executeQuery();\n\t\t\twhile (rs.next()) {\n\t\t\t\tm.put(new Integer(rs.getInt(\"group_id\")), new Integer(rs.getInt(\"quota_limit_id\")));\n\t\t\t}\n\n\t\t\treturn m;\n\t\t}\n\t\tcatch (SQLException e) {\n\t\t\tthrow new DatabaseException(e);\n\t\t}\n\t\tfinally {\n\t\t\tDbUtils.close(rs, p);\n\t\t}\n\t}\n\n\tprotected QuotaLimit getQuotaLimit(ResultSet rs) throws SQLException\n\t{\n\t\tQuotaLimit ql = new QuotaLimit();\n\t\tql.setDescription(rs.getString(\"quota_desc\"));\n\t\tql.setId(rs.getInt(\"quota_limit_id\"));\n\t\tql.setSize(rs.getInt(\"quota_limit\"));\n\t\tql.setType(rs.getInt(\"quota_type\"));\n\n\t\treturn ql;\n\t}\n\n\t/**\n\t * @see net.jforum.dao.AttachmentDAO#addExtensionGroup(net.jforum.entities.AttachmentExtensionGroup)\n\t */\n\tpublic void addExtensionGroup(AttachmentExtensionGroup g)\n\t{\n\t\tPreparedStatement p = null;\n\t\ttry {\n\t\t\tp = JForumExecutionContext.getConnection().prepareStatement(\n\t\t\t\t\tSystemGlobals.getSql(\"AttachmentModel.addExtensionGroup\"));\n\t\t\tp.setString(1, g.getName());\n\t\t\tp.setInt(2, g.isAllow() ? 1 : 0);\n\t\t\tp.setString(3, g.getUploadIcon());\n\t\t\tp.setInt(4, g.getDownloadMode());\n\t\t\tp.executeUpdate();\n\t\t}\n\t\tcatch (SQLException e) {\n\t\t\tthrow new DatabaseException(e);\n\t\t}\n\t\tfinally {\n\t\t\tDbUtils.close(p);\n\t\t}\n\t}\n\n\t/**\n\t * @see net.jforum.dao.AttachmentDAO#removeExtensionGroups(java.lang.String[])\n\t */\n\tpublic void removeExtensionGroups(String[] ids)\n\t{\n\t\tPreparedStatement p = null;\n\t\ttry {\n\t\t\tp = JForumExecutionContext.getConnection().prepareStatement(\n\t\t\t\t\tSystemGlobals.getSql(\"AttachmentModel.removeExtensionGroups\"));\n\n\t\t\tfor (int i = 0; i < ids.length; i++) {\n\t\t\t\tp.setInt(1, Integer.parseInt(ids[i]));\n\t\t\t\tp.executeUpdate();\n\t\t\t}\n\t\t}\n\t\tcatch (SQLException e) {\n\t\t\tthrow new DatabaseException(e);\n\t\t}\n\t\tfinally {\n\t\t\tDbUtils.close(p);\n\t\t}\n\t}\n\n\t/**\n\t * @see net.jforum.dao.AttachmentDAO#selectExtensionGroups()\n\t */\n\tpublic List selectExtensionGroups()\n\t{\n\t\tList l = new ArrayList();\n\n\t\tPreparedStatement p = null;\n\t\tResultSet rs = null;\n\t\ttry {\n\t\t\tp = JForumExecutionContext.getConnection().prepareStatement(\n\t\t\t\t\tSystemGlobals.getSql(\"AttachmentModel.selectExtensionGroups\"));\n\n\t\t\trs = p.executeQuery();\n\t\t\twhile (rs.next()) {\n\t\t\t\tl.add(this.getExtensionGroup(rs));\n\t\t\t}\n\n\t\t\treturn l;\n\t\t}\n\t\tcatch (SQLException e) {\n\t\t\tthrow new DatabaseException(e);\n\t\t}\n\t\tfinally {\n\t\t\tDbUtils.close(rs, p);\n\t\t}\n\t}\n\n\t/**\n\t * @see net.jforum.dao.AttachmentDAO#extensionsForSecurity()\n\t */\n\tpublic Map extensionsForSecurity()\n\t{\n\t\tMap m = new HashMap();\n\n\t\tPreparedStatement p = null;\n\t\tResultSet rs = null;\n\t\ttry {\n\t\t\tp = JForumExecutionContext.getConnection().prepareStatement(\n\t\t\t\t\tSystemGlobals.getSql(\"AttachmentModel.extensionsForSecurity\"));\n\n\t\t\trs = p.executeQuery();\n\t\t\twhile (rs.next()) {\n\t\t\t\tint allow = rs.getInt(\"group_allow\");\n\t\t\t\tif (allow == 1) {\n\t\t\t\t\tallow = rs.getInt(\"allow\");\n\t\t\t\t}\n\n\t\t\t\tm.put(rs.getString(\"extension\"), Boolean.valueOf(allow == 1));\n\t\t\t}\n\n\t\t\treturn m;\n\t\t}\n\t\tcatch (SQLException e) {\n\t\t\tthrow new DatabaseException(e);\n\t\t}\n\t\tfinally {\n\t\t\tDbUtils.close(rs, p);\n\t\t}\n\t}\n\n\t/**\n\t * @see net.jforum.dao.AttachmentDAO#updateExtensionGroup(net.jforum.entities.AttachmentExtensionGroup)\n\t */\n\tpublic void updateExtensionGroup(AttachmentExtensionGroup g)\n\t{\n\t\tPreparedStatement p = null;\n\t\ttry {\n\t\t\tp = JForumExecutionContext.getConnection().prepareStatement(\n\t\t\t\t\tSystemGlobals.getSql(\"AttachmentModel.updateExtensionGroups\"));\n\t\t\tp.setString(1, g.getName());\n\t\t\tp.setInt(2, g.isAllow() ? 1 : 0);\n\t\t\tp.setString(3, g.getUploadIcon());\n\t\t\tp.setInt(4, g.getDownloadMode());\n\t\t\tp.setInt(5, g.getId());\n\t\t\tp.executeUpdate();\n\t\t}\n\t\tcatch (SQLException e) {\n\t\t\tthrow new DatabaseException(e);\n\t\t}\n\t\tfinally {\n\t\t\tDbUtils.close(p);\n\t\t}\n\t}\n\n\tprotected AttachmentExtensionGroup getExtensionGroup(ResultSet rs) throws SQLException\n\t{\n\t\tAttachmentExtensionGroup g = new AttachmentExtensionGroup();\n\t\tg.setId(rs.getInt(\"extension_group_id\"));\n\t\tg.setName(rs.getString(\"name\"));\n\t\tg.setUploadIcon(rs.getString(\"upload_icon\"));\n\t\tg.setAllow(rs.getInt(\"allow\") == 1);\n\t\tg.setDownloadMode(rs.getInt(\"download_mode\"));\n\n\t\treturn g;\n\t}\n\n\t/**\n\t * @see net.jforum.dao.AttachmentDAO#addExtension(net.jforum.entities.AttachmentExtension)\n\t */\n\tpublic void addExtension(AttachmentExtension extension)\n\t{\n\t\tPreparedStatement p = null;\n\t\ttry {\n\t\t\tp = JForumExecutionContext.getConnection().prepareStatement(\n\t\t\t\t\tSystemGlobals.getSql(\"AttachmentModel.addExtension\"));\n\t\t\tp.setInt(1, extension.getExtensionGroupId());\n\t\t\tp.setString(2, extension.getComment());\n\t\t\tp.setString(3, extension.getUploadIcon());\n\t\t\tp.setString(4, extension.getExtension().toLowerCase());\n\t\t\tp.setInt(5, extension.isAllow() ? 1 : 0);\n\t\t\tp.executeUpdate();\n\t\t}\n\t\tcatch (SQLException ex) {\n\t\t\tthrow new DatabaseException(ex);\n\t\t}\n\t\tfinally {\n\t\t\tDbUtils.close(p);\n\t\t}\n\t}\n\n\t/**\n\t * @see net.jforum.dao.AttachmentDAO#removeExtensions(java.lang.String[])\n\t */\n\tpublic void removeExtensions(String[] ids)\n\t{\n\t\tPreparedStatement p = null;\n\t\ttry {\n\t\t\tp = JForumExecutionContext.getConnection().prepareStatement(\n\t\t\t\t\tSystemGlobals.getSql(\"AttachmentModel.removeExtension\"));\n\t\t\tfor (int i = 0; i < ids.length; i++) {\n\t\t\t\tp.setInt(1, Integer.parseInt(ids[i]));\n\t\t\t\tp.executeUpdate();\n\t\t\t}\n\t\t}\n\t\tcatch (SQLException e) {\n\t\t\tthrow new DatabaseException(e);\n\t\t}\n\t\tfinally {\n\t\t\tDbUtils.close(p);\n\t\t}\n\t}\n\n\t/**\n\t * @see net.jforum.dao.AttachmentDAO#selectExtensions()\n\t */\n\tpublic List selectExtensions()\n\t{\n\t\tList l = new ArrayList();\n\n\t\tPreparedStatement p = null;\n\t\tResultSet rs = null;\n\t\ttry {\n\t\t\tp = JForumExecutionContext.getConnection().prepareStatement(\n\t\t\t\t\tSystemGlobals.getSql(\"AttachmentModel.selectExtensions\"));\n\n\t\t\trs = p.executeQuery();\n\t\t\twhile (rs.next()) {\n\t\t\t\tl.add(this.getExtension(rs));\n\t\t\t}",
  "metadata": {
    "fileId": "GenericAttachmentDAO_java_chunk_2",
    "fileName": "GenericAttachmentDAO.java",
    "filePath": "src/net/jforum/dao/generic/GenericAttachmentDAO.java"
  }
}
{
  "pageContent": "File Path: src/net/jforum/dao/generic/GenericMailIntegrationDAO.java\n\n Original Content: /*\n * Created on 28/08/2006 23:12:09\n */\npackage net.jforum.dao.generic;\n\nimport java.sql.PreparedStatement;\nimport java.sql.ResultSet;\nimport java.sql.SQLException;\nimport java.util.ArrayList;\nimport java.util.List;\n\nimport net.jforum.JForumExecutionContext;\nimport net.jforum.dao.MailIntegrationDAO;\nimport net.jforum.entities.MailIntegration;\nimport net.jforum.exceptions.DatabaseException;\nimport net.jforum.util.DbUtils;\nimport net.jforum.util.preferences.SystemGlobals;\n\n/**\n * @author Rafael Steil\n * @version $Id: GenericMailIntegrationDAO.java,v 1.3 2006/10/10 00:19:09 rafaelsteil Exp $\n */\npublic class GenericMailIntegrationDAO implements MailIntegrationDAO\n{\n\t/**\n\t * @see net.jforum.dao.MailIntegrationDAO#add(net.jforum.entities.MailIntegration)\n\t */\n\tpublic void add(MailIntegration integration)\n\t{\n\t\tPreparedStatement p = null;\n\t\t\n\t\ttry {\n\t\t\tp = JForumExecutionContext.getConnection().prepareStatement(\n\t\t\t\tSystemGlobals.getSql(\"MailIntegration.add\"));\n\t\t\tthis.prepareForSave(integration, p);\n\t\t\tp.executeUpdate();\n\t\t}\n\t\tcatch (SQLException e) {\n\t\t\tthrow new DatabaseException(e);\n\t\t}\n\t\tfinally {\n\t\t\tDbUtils.close(p);\n\t\t}\n\t}\n\t\n\t/**\n\t * @see net.jforum.dao.MailIntegrationDAO#delete(int)\n\t */\n\tpublic void delete(int forumId)\n\t{\n\t\tPreparedStatement p = null;\n\t\t\n\t\ttry {\n\t\t\tp = JForumExecutionContext.getConnection().prepareStatement(\n\t\t\t\tSystemGlobals.getSql(\"MailIntegration.delete\"));\n\t\t\tp.setInt(1, forumId);\n\t\t\tp.executeUpdate();\n\t\t}\n\t\tcatch (SQLException e) {\n\t\t\tthrow new DatabaseException(e);\n\t\t}\n\t\tfinally {\n\t\t\tDbUtils.close(p);\n\t\t}\n\t}\n\n\t/**\n\t * @see net.jforum.dao.MailIntegrationDAO#find(int)\n\t */\n\tpublic MailIntegration find(int forumId)\n\t{\n\t\tMailIntegration m = null;\n\t\t\n\t\tPreparedStatement p = null;\n\t\tResultSet rs = null;\n\t\t\n\t\ttry {\n\t\t\tp = JForumExecutionContext.getConnection().prepareStatement(\n\t\t\t\t\tSystemGlobals.getSql(\"MailIntegration.find\"));\n\t\t\tp.setInt(1, forumId);\n\t\t\trs = p.executeQuery();\n\t\t\t\n\t\t\tif (rs.next()) {\n\t\t\t\tm = this.buildMailIntegration(rs);\n\t\t\t}\n\t\t}\n\t\tcatch (SQLException e) {\n\t\t\tthrow new DatabaseException(e);\n\t\t}\n\t\tfinally {\n\t\t\tDbUtils.close(rs, p);\n\t\t}\n\t\t\n\t\treturn m;\n\t}\n\n\t/**\n\t * @see net.jforum.dao.MailIntegrationDAO#findAll()\n\t */\n\tpublic List findAll()\n\t{\n\t\tList l = new ArrayList();\n\t\t\n\t\tPreparedStatement p = null;\n\t\tResultSet rs = null;\n\t\t\n\t\ttry {\n\t\t\tp = JForumExecutionContext.getConnection().prepareStatement(\n\t\t\t\t\tSystemGlobals.getSql(\"MailIntegration.findAll\"));\n\t\t\trs = p.executeQuery();\n\t\t\t\n\t\t\twhile (rs.next()) {\n\t\t\t\tl.add(this.buildMailIntegration(rs));\n\t\t\t}\n\t\t}\n\t\tcatch (SQLException e) {\n\t\t\tthrow new DatabaseException(e);\n\t\t}\n\t\tfinally {\n\t\t\tDbUtils.close(rs, p);\n\t\t}\n\t\t\n\t\treturn l;\n\t}\n\n\t/**\n\t * @see net.jforum.dao.MailIntegrationDAO#update(net.jforum.entities.MailIntegration)\n\t */\n\tpublic void update(MailIntegration integration)\n\t{\n\t\tPreparedStatement p = null;\n\t\t\n\t\ttry {\n\t\t\tp = JForumExecutionContext.getConnection().prepareStatement(\n\t\t\t\tSystemGlobals.getSql(\"MailIntegration.update\"));\n\t\t\t\n\t\t\tthis.prepareForSave(integration, p);\n\t\t\tp.setInt(8, integration.getForumId());\n\t\t\t\n\t\t\tp.executeUpdate();\n\t\t}\n\t\tcatch (SQLException e) {\n\t\t\tthrow new DatabaseException(e);\n\t\t}\n\t\tfinally {\n\t\t\tDbUtils.close(p);\n\t\t}\n\t}\n\t\n\tprivate MailIntegration buildMailIntegration(ResultSet rs) throws SQLException\n\t{\n\t\tMailIntegration mi = new MailIntegration();\n\t\t\n\t\tmi.setForumId(rs.getInt(\"forum_id\"));\n\t\tmi.setForumEmail(rs.getString(\"forum_email\"));\n\t\tmi.setPopHost(rs.getString(\"pop_host\"));\n\t\tmi.setPopPassword(rs.getString(\"pop_password\"));\n\t\tmi.setPopPort(rs.getInt(\"pop_port\"));\n\t\tmi.setPopUsername(rs.getString(\"pop_username\"));\n\t\tmi.setSSL(rs.getInt(\"pop_ssl\") == 1);\n\t\t\n\t\treturn mi;\n\t}\n\n\t/**\n\t * Given a PreparedStatement, fill its values with the data of a MailIntegration instance\n\t * @param integration the data to fill the statement\n\t * @param p the statement to be filled\n\t * @throws SQLException\n\t */\n\tprivate void prepareForSave(MailIntegration integration, PreparedStatement p) throws SQLException\n\t{\n\t\tp.setInt(1, integration.getForumId());\n\t\tp.setString(2, integration.getForumEmail());\n\t\tp.setString(3, integration.getPopHost());\n\t\tp.setString(4, integration.getPopUsername());\n\t\tp.setString(5, integration.getPopPassword());\n\t\tp.setInt(6, integration.getPopPort());\n\t\tp.setInt(7, integration.isSSL() ? 1 : 0);\n\t}\n}",
  "metadata": {
    "fileId": "GenericMailIntegrationDAO_java_chunk_1",
    "fileName": "GenericMailIntegrationDAO.java",
    "filePath": "src/net/jforum/dao/generic/GenericMailIntegrationDAO.java"
  }
}
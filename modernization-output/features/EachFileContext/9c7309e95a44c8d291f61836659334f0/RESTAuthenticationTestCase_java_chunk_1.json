{
  "pageContent": "File Path: tests/core/net/jforum/api/integration/rest/RESTAuthenticationTestCase.java\n\n Original Content: /*\n * Created on 09/09/2006 17:00:27\n */\npackage net.jforum.api.integration.rest;\n\nimport java.sql.PreparedStatement;\nimport java.sql.SQLException;\nimport java.sql.Timestamp;\nimport java.util.Calendar;\nimport java.util.Date;\nimport java.util.GregorianCalendar;\n\nimport junit.framework.TestCase;\nimport net.jforum.JForumExecutionContext;\nimport net.jforum.TestCaseUtils;\nimport net.jforum.api.rest.RESTAuthentication;\n\n/**\n * @author Rafael Steil\n * @version $Id: RESTAuthenticationTestCase.java,v 1.4 2007/07/28 14:17:11 rafaelsteil Exp $\n */\npublic class RESTAuthenticationTestCase extends TestCase\n{\n\tpublic static final String API_KEY = \"api.key.test\";\n\t\n\tpublic void testInvalid() throws Exception\n\t{\n\t\tRESTAuthentication auth = new RESTAuthentication();\n\t\tboolean isValid = auth.validateApiKey(\"1\");\n\t\t\n\t\tassertFalse(\"The api key should not be valid\", isValid);\n\t}\n\t\n\tpublic void testValid() throws Exception\n\t{\n\t\tRESTAuthentication auth = new RESTAuthentication();\n\t\tboolean isValid = auth.validateApiKey(API_KEY);\n\t\t\n\t\tassertTrue(\"The api key should be valid\", isValid);\n\t}\n\t\n\tDate tomorrow()\n\t{\n\t\tCalendar c = Calendar.getInstance();\n\t\treturn new GregorianCalendar(c.get(Calendar.YEAR), \n\t\t\tc.get(Calendar.MONTH), \n\t\t\tc.get(Calendar.DATE) + 1).getTime();\n\t}\n\n\t/**\n\t * @throws SQLException\n\t */\n\tvoid createApiKey(Date validity) throws SQLException\n\t{\n\t\tPreparedStatement p = null;\n\t\t\n\t\ttry {\n\t\t\tp = JForumExecutionContext.getConnection()\n\t\t\t\t.prepareStatement(\"INSERT INTO jforum_api (api_key, api_validity) \"\n\t\t\t\t\t\t+ \" VALUES (?, ?)\");\n\t\t\tp.setString(1, API_KEY);\n\t\t\tp.setTimestamp(2, new Timestamp(validity.getTime()));\n\t\t\tp.executeUpdate();\n\t\t}\n\t\tfinally {\n\t\t\tif (p != null) p.close();\n\t\t}\n\t}\n\n\t/**\n\t * @throws SQLException\n\t */\n\tvoid deleteApiKey() throws SQLException\n\t{\n\t\tPreparedStatement p = null;\n\t\t\n\t\ttry {\n\t\t\tp = JForumExecutionContext.getConnection()\n\t\t\t\t.prepareStatement(\"DELETE FROM jforum_api WHERE api_key = ?\");\n\t\t\tp.setString(1, API_KEY);\n\t\t\tp.executeUpdate();\n\t\t}\n\t\tfinally {\n\t\t\tif (p != null) p.close();\n\t\t}\n\t}\n\t\n\t/**\n\t * @see junit.framework.TestCase#setUp()\n\t */\n\tprotected void setUp() throws Exception\n\t{\n\t\tTestCaseUtils.loadEnvironment();\n\t\tTestCaseUtils.initDatabaseImplementation();\n\t\tthis.createApiKey(this.tomorrow());\n\t}\n\n\t/**\n\t * @see junit.framework.TestCase#tearDown()\n\t */\n\tprotected void tearDown() throws Exception\n\t{\n\t\tthis.deleteApiKey();\n\t\tJForumExecutionContext.finish();\n\t}\n}",
  "metadata": {
    "fileId": "RESTAuthenticationTestCase_java_chunk_1",
    "fileName": "RESTAuthenticationTestCase.java",
    "filePath": "tests/core/net/jforum/api/integration/rest/RESTAuthenticationTestCase.java"
  }
}